// Generated by CoffeeScript 2.5.1
var SIZE,
  indexOf = [].indexOf;

import {
  ass,
  lerp,
  param,
  range
} from '../js/utils.js';

import {
  Square
} from '../js/square.js';

import {
  Button
} from '../js/button.js';

import {
  coords,
  clickString,
  getMove,
  global,
  loadTree,
  fixSuper,
  toObjectNotation
} from '../js/globals.js';

SIZE = global.SIZE;

export var Board = (function() {
  var calcBar;

  class Board {
    constructor() {
      var i, k, len, ref, x0, x1, x2, x3;
      this.start = this.start.bind(this);
      this.click = this.click.bind(this);
      this.move = this.move.bind(this);
      this.draw = this.draw.bind(this);
      this.littera = this.littera.bind(this);
      this.flip = this.flip.bind(this);
      this.squares = [];
      this.clickedSquares = [];
      this.pieces = "";
      this.flipped = false;
      ref = range(64);
      for (k = 0, len = ref.length; k < len; k++) {
        i = ref[k];
        ((i) => {
          return this.squares.push(new Square(i, () => {
            return this.click(i);
          }));
        })(i);
      }
      this.start();
      this.buttons = [];
      x0 = 1.5;
      x1 = 3.5;
      x2 = 5.5;
      x3 = 7.5;
      this.buttons.push(new Button(x0 * SIZE, 9.5 * SIZE, 'undo', () => {
        return clickString('undo');
      }));
      //@buttons.push new Button x0*SIZE, 9.5*SIZE, 'first',    => clickString 'first'
      //@buttons.push new Button x1*SIZE, 9.5*SIZE, 'move -1',  => clickString 'prev'
      //@buttons.push new Button x2*SIZE, 9.5*SIZE, 'move +1',  => clickString 'next'
      //@buttons.push new Button x3*SIZE, 9.5*SIZE, 'last',     => clickString 'last'
      this.buttons.push(new Button(x0 * SIZE, 10.5 * SIZE, 'flip', () => {
        return clickString('flip');
      }));
      //@buttons.push new Button x1*SIZE, 10.5*SIZE, 'game -1', => clickString 'pgup'
      //@buttons.push new Button x2*SIZE, 10.5*SIZE, 'game +1', => clickString 'pgdn'
      this.buttons.push(new Button(x3 * SIZE, 10.5 * SIZE, 'link', () => {
        return clickString('link');
      }));
    }

    start() {
      return this.pieces = "RNBQKBNRPPPPPPPP33333333444444445555555566666666pppppppprnbqkbnr";
    }

    click(i) {
      var move;
      if (this.clickedSquares.length === 0) {
        if (true) { // pjäs av rätt färg
          this.clickedSquares.push(i);
        }
      } else if (this.clickedSquares.length === 1) {
        if (i === this.clickedSquares[0]) {
          this.clickedSquares = [];
        } else {
          this.clickedSquares.push(i);
          move = toObjectNotation(this.clickedSquares[0], this.clickedSquares[1]);
          this.clickedSquares = [];
          console.log(move);
          global.chess.move(move);
          console.log(global.chess.history());
        }
      } else {
        this.clickedSquares = [i];
      }
      return console.log('sqclick', this.clickedSquares);
    }

    move(i) {
      var key, m;
      param.Integer(i);
      console.log('move', i);
      m = global.moves[global.index - 1];
      if (i === 0) {
        key = m.uci;
      } else {
        key = m.superiors[i - 1];
      }
      this.pieces = makeMove(key, global.piecess[global.index - 1]);
      global.superIndex = i + 1;
      return fixSuper(0);
    }

    draw() {
      var button, i, j, k, l, len, len1, len2, n, piece, ref, ref1, ref2, score;
      ref = this.buttons;
      for (k = 0, len = ref.length; k < len; k++) {
        button = ref[k];
        button.draw();
      }
      if (!global.tree) {
        return;
      }
      fill('white');
      textSize(SIZE * 0.3);
      push();
      textAlign(LEFT, CENTER);
      text(global.filename, 0.05 * SIZE, 0.3 * SIZE);
      pop();
      ref1 = range(8);
      for (l = 0, len1 = ref1.length; l < len1; l++) {
        i = ref1[l];
        ref2 = range(8);
        for (n = 0, len2 = ref2.length; n < len2; n++) {
          j = ref2[n];
          piece = global.chess.board()[7 - i][j];
          this.squares[i * 8 + j].draw(piece, this.flipped, i * 8 + j === this.clickedSquares[0]);
        }
      }
      stroke('black');
      noFill();
      rect(SIZE * 4.5, SIZE * 4.5, SIZE * 8, SIZE * 8);
      this.littera();
      push();
      textAlign(CENTER, CENTER);
      if (global.index > 0) {
        text('move: ' + (1 + Math.floor(global.index / 2)) + "BW"[global.index % 2] + " of " + (1 + Math.floor(global.moves.length / 2)), 4.5 * SIZE, 10 * SIZE);
      }
      if (global.index === 0) {
        score = '0';
      } else {
        if (global.superIndex === 0) {
          score = global.moves[global.index - 1].score;
        } else {
          score = global.moves[global.index - 1].scores[global.superIndex - 1];
        }
      }
      text('depth: ' + global.tree.depth, 1.5 * SIZE, 10 * SIZE);
      text(global.version, 7.5 * SIZE, 10 * SIZE);
      textAlign(RIGHT, CENTER);
      fill('white');
      text(score, 10.1 * SIZE, 0.3 * SIZE);
      pop();
      return this.drawBars(score);
    }

    littera() {
      var digits, i, k, len, letters, ref, results;
      noStroke();
      fill('black');
      textSize(SIZE * 0.3);
      letters = this.flipped ? "hgfedcba" : "abcdefgh";
      digits = this.flipped ? "12345678" : "87654321";
      ref = range(8);
      results = [];
      for (k = 0, len = ref.length; k < len; k++) {
        i = ref[k];
        text(letters[i], SIZE * (i + 1), SIZE * 8.8);
        results.push(text(digits[i], SIZE * 0.15, SIZE * (i + 1)));
      }
      return results;
    }

    flip() {
      return this.flipped = !this.flipped;
    }

    drawBars(score) {
      var h, w, x;
      param.String(score);
      stroke('black');
      h = calcBar(score);
      push();
      if (this.flipped) {
        translate(0, SIZE * 9);
        scale(1, -1);
      }
      rectMode(CORNER);
      noStroke();
      x = 0.35 * SIZE;
      w = 0.10 * SIZE;
      fill('black');
      rect(x, 0.5 * SIZE, w, SIZE * 4);
      fill('white');
      rect(x, 4.5 * SIZE, w, SIZE * 4);
      if (h > 0) {
        fill('white');
        rect(x, 4.5 * SIZE - h, w, h);
      } else {
        fill('black');
        rect(x, 4.5 * SIZE, w, -h);
      }
      return pop();
    }

  };

  calcBar = (score) => {
    var LIMIT, d, res;
    param.String(score);
    LIMIT = 2000;
    if (score[0] === '#') {
      d = LIMIT;
    } else {
      d = Math.abs(score);
    }
    if (d > LIMIT) {
      d = LIMIT;
    }
    res = lerp(0, 4 * SIZE, d / LIMIT);
    if (indexOf.call(score, "-") >= 0) {
      res = -res;
    }
    return param.Integer(Math.round(res));
  };

  ass(4 * SIZE, calcBar("2100"));

  ass(4 * SIZE, calcBar("2000"));

  ass(2 * SIZE, calcBar("1000"));

  ass(SIZE, calcBar("500"));

  ass(0, calcBar("1"));

  ass(-SIZE, calcBar("-500"));

  ass(-4 * SIZE, calcBar("#-1"));

  return Board;

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm9hcmQuanMiLCJzb3VyY2VSb290IjoiLi4iLCJzb3VyY2VzIjpbImNvZmZlZVxcYm9hcmQuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBLElBQUE7RUFBQTs7QUFBQSxPQUFBO0VBQVEsR0FBUjtFQUFZLElBQVo7RUFBaUIsS0FBakI7RUFBdUIsS0FBdkI7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxNQUFSO0NBQUEsTUFBQTs7QUFDQSxPQUFBO0VBQVEsTUFBUjtDQUFBLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLE1BQVI7RUFBZSxXQUFmO0VBQTJCLE9BQTNCO0VBQW1DLE1BQW5DO0VBQTJDLFFBQTNDO0VBQXFELFFBQXJEO0VBQThELGdCQUE5RDtDQUFBLE1BQUE7O0FBRUEsSUFBQSxHQUFPLE1BQU0sQ0FBQzs7QUFFZCxPQUFBLElBQWE7OztFQUFOLE1BQUEsTUFBQTtJQUNOLFdBQWEsQ0FBQSxDQUFBO0FBQ2QsVUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUE7VUF1QkMsQ0FBQSxZQUFBLENBQUE7VUFHQSxDQUFBLFlBQUEsQ0FBQTtVQW1CQSxDQUFBLFdBQUEsQ0FBQTtVQVNBLENBQUEsV0FBQSxDQUFBO1VBK0NBLENBQUEsY0FBQSxDQUFBO1VBV0EsQ0FBQSxXQUFBLENBQUE7TUFoSEMsSUFBQyxDQUFBLE9BQUQsR0FBVztNQUNYLElBQUMsQ0FBQSxjQUFELEdBQWtCO01BQ2xCLElBQUMsQ0FBQSxNQUFELEdBQVU7TUFDVixJQUFDLENBQUEsT0FBRCxHQUFXO0FBQ1g7TUFBQSxLQUFBLHFDQUFBOztRQUNJLENBQUEsQ0FBQyxDQUFELENBQUEsR0FBQTtpQkFBTyxJQUFDLENBQUEsT0FBTyxDQUFDLElBQVQsQ0FBYyxJQUFJLE1BQUosQ0FBVyxDQUFYLEVBQWMsQ0FBQSxDQUFBLEdBQUE7bUJBQUcsSUFBQyxDQUFBLEtBQUQsQ0FBTyxDQUFQO1VBQUgsQ0FBZCxDQUFkO1FBQVAsQ0FBQSxFQUFDO01BREw7TUFFQSxJQUFDLENBQUEsS0FBRCxDQUFBO01BRUEsSUFBQyxDQUFBLE9BQUQsR0FBVztNQUNYLEVBQUEsR0FBSztNQUNMLEVBQUEsR0FBSztNQUNMLEVBQUEsR0FBSztNQUNMLEVBQUEsR0FBSztNQUNMLElBQUMsQ0FBQSxPQUFPLENBQUMsSUFBVCxDQUFjLElBQUksTUFBSixDQUFXLEVBQUEsR0FBRyxJQUFkLEVBQW9CLEdBQUEsR0FBSSxJQUF4QixFQUE4QixNQUE5QixFQUF5QyxDQUFBLENBQUEsR0FBQTtlQUFHLFdBQUEsQ0FBWSxNQUFaO01BQUgsQ0FBekMsQ0FBZCxFQWJGOzs7OztNQW1CRSxJQUFDLENBQUEsT0FBTyxDQUFDLElBQVQsQ0FBYyxJQUFJLE1BQUosQ0FBVyxFQUFBLEdBQUcsSUFBZCxFQUFvQixJQUFBLEdBQUssSUFBekIsRUFBK0IsTUFBL0IsRUFBMEMsQ0FBQSxDQUFBLEdBQUE7ZUFBRyxXQUFBLENBQVksTUFBWjtNQUFILENBQTFDLENBQWQsRUFuQkY7OztNQXNCRSxJQUFDLENBQUEsT0FBTyxDQUFDLElBQVQsQ0FBYyxJQUFJLE1BQUosQ0FBVyxFQUFBLEdBQUcsSUFBZCxFQUFvQixJQUFBLEdBQUssSUFBekIsRUFBK0IsTUFBL0IsRUFBMEMsQ0FBQSxDQUFBLEdBQUE7ZUFBRyxXQUFBLENBQVksTUFBWjtNQUFILENBQTFDLENBQWQ7SUF2Qlk7O0lBd0JiLEtBQVEsQ0FBQSxDQUFBO2FBQ1AsSUFBQyxDQUFBLE1BQUQsR0FBVTtJQURIOztJQUdSLEtBQVEsQ0FBQyxDQUFELENBQUE7QUFDVCxVQUFBO01BQUUsSUFBRyxJQUFDLENBQUEsY0FBYyxDQUFDLE1BQWhCLEtBQTBCLENBQTdCO1FBQ0MsSUFBRyxJQUFIO1VBQ0MsSUFBQyxDQUFBLGNBQWMsQ0FBQyxJQUFoQixDQUFxQixDQUFyQixFQUREO1NBREQ7T0FBQSxNQUdLLElBQUcsSUFBQyxDQUFBLGNBQWMsQ0FBQyxNQUFoQixLQUEwQixDQUE3QjtRQUNKLElBQUcsQ0FBQSxLQUFHLElBQUMsQ0FBQSxjQUFjLENBQUMsQ0FBRCxDQUFyQjtVQUNDLElBQUMsQ0FBQSxjQUFELEdBQWtCLEdBRG5CO1NBQUEsTUFBQTtVQUdDLElBQUMsQ0FBQSxjQUFjLENBQUMsSUFBaEIsQ0FBcUIsQ0FBckI7VUFDQSxJQUFBLEdBQU8sZ0JBQUEsQ0FBaUIsSUFBQyxDQUFBLGNBQWMsQ0FBQyxDQUFELENBQWhDLEVBQW9DLElBQUMsQ0FBQSxjQUFjLENBQUMsQ0FBRCxDQUFuRDtVQUNQLElBQUMsQ0FBQSxjQUFELEdBQWtCO1VBQ2xCLE9BQU8sQ0FBQyxHQUFSLENBQVksSUFBWjtVQUNBLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBYixDQUFrQixJQUFsQjtVQUNBLE9BQU8sQ0FBQyxHQUFSLENBQVksTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFiLENBQUEsQ0FBWixFQVJEO1NBREk7T0FBQSxNQUFBO1FBWUosSUFBQyxDQUFBLGNBQUQsR0FBa0IsQ0FBQyxDQUFELEVBWmQ7O2FBYUwsT0FBTyxDQUFDLEdBQVIsQ0FBWSxTQUFaLEVBQXNCLElBQUMsQ0FBQSxjQUF2QjtJQWpCTzs7SUFtQlIsSUFBTyxDQUFDLENBQUQsQ0FBQTtBQUNSLFVBQUEsR0FBQSxFQUFBO01BQUUsS0FBSyxDQUFDLE9BQU4sQ0FBYyxDQUFkO01BQ0EsT0FBTyxDQUFDLEdBQVIsQ0FBWSxNQUFaLEVBQW1CLENBQW5CO01BQ0EsQ0FBQSxHQUFJLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQVAsR0FBYSxDQUFkO01BQ2hCLElBQUcsQ0FBQSxLQUFHLENBQU47UUFBYSxHQUFBLEdBQU0sQ0FBQyxDQUFDLElBQXJCO09BQUEsTUFBQTtRQUE4QixHQUFBLEdBQU0sQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFBLEdBQUUsQ0FBSCxFQUEvQzs7TUFDQSxJQUFDLENBQUEsTUFBRCxHQUFVLFFBQUEsQ0FBUyxHQUFULEVBQWMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBUCxHQUFhLENBQWQsQ0FBNUI7TUFDVixNQUFNLENBQUMsVUFBUCxHQUFvQixDQUFBLEdBQUU7YUFDdEIsUUFBQSxDQUFTLENBQVQ7SUFQTTs7SUFTUCxJQUFPLENBQUEsQ0FBQTtBQUVSLFVBQUEsTUFBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBLElBQUEsRUFBQSxDQUFBLEVBQUEsS0FBQSxFQUFBLEdBQUEsRUFBQSxJQUFBLEVBQUEsSUFBQSxFQUFBO0FBQUU7TUFBQSxLQUFBLHFDQUFBOztRQUNDLE1BQU0sQ0FBQyxJQUFQLENBQUE7TUFERDtNQUdBLElBQUcsQ0FBSSxNQUFNLENBQUMsSUFBZDtBQUF3QixlQUF4Qjs7TUFFQSxJQUFBLENBQUssT0FBTDtNQUNBLFFBQUEsQ0FBUyxJQUFBLEdBQUssR0FBZDtNQUVBLElBQUEsQ0FBQTtNQUNBLFNBQUEsQ0FBVSxJQUFWLEVBQWUsTUFBZjtNQUNBLElBQUEsQ0FBSyxNQUFNLENBQUMsUUFBWixFQUFxQixJQUFBLEdBQUssSUFBMUIsRUFBZ0MsR0FBQSxHQUFJLElBQXBDO01BQ0EsR0FBQSxDQUFBO0FBRUE7TUFBQSxLQUFBLHdDQUFBOztBQUNDO1FBQUEsS0FBQSx3Q0FBQTs7VUFDQyxLQUFBLEdBQVEsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFiLENBQUEsQ0FBb0IsQ0FBQyxDQUFBLEdBQUUsQ0FBSCxDQUFLLENBQUMsQ0FBRDtVQUNqQyxJQUFDLENBQUEsT0FBTyxDQUFDLENBQUEsR0FBRSxDQUFGLEdBQUksQ0FBTCxDQUFPLENBQUMsSUFBaEIsQ0FBcUIsS0FBckIsRUFBNEIsSUFBQyxDQUFBLE9BQTdCLEVBQXNDLENBQUEsR0FBRSxDQUFGLEdBQUksQ0FBSixLQUFPLElBQUMsQ0FBQSxjQUFjLENBQUMsQ0FBRCxDQUE1RDtRQUZEO01BREQ7TUFLQSxNQUFBLENBQU8sT0FBUDtNQUNBLE1BQUEsQ0FBQTtNQUNBLElBQUEsQ0FBSyxJQUFBLEdBQUssR0FBVixFQUFjLElBQUEsR0FBSyxHQUFuQixFQUF1QixJQUFBLEdBQUssQ0FBNUIsRUFBOEIsSUFBQSxHQUFLLENBQW5DO01BRUEsSUFBQyxDQUFBLE9BQUQsQ0FBQTtNQUVBLElBQUEsQ0FBQTtNQUNBLFNBQUEsQ0FBVSxNQUFWLEVBQWlCLE1BQWpCO01BQ0EsSUFBRyxNQUFNLENBQUMsS0FBUCxHQUFlLENBQWxCO1FBQ0MsSUFBQSxDQUFLLFFBQUEsR0FBVyxDQUFDLENBQUEsY0FBRSxNQUFNLENBQUMsUUFBTyxFQUFqQixDQUFYLEdBQWlDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBUCxHQUFhLENBQWQsQ0FBckMsR0FBdUQsTUFBdkQsR0FBK0QsQ0FBQyxDQUFBLGNBQUUsTUFBTSxDQUFDLEtBQUssQ0FBQyxTQUFRLEVBQXhCLENBQXBFLEVBQWdHLEdBQUEsR0FBSSxJQUFwRyxFQUEwRyxFQUFBLEdBQUcsSUFBN0csRUFERDs7TUFFQSxJQUFHLE1BQU0sQ0FBQyxLQUFQLEtBQWMsQ0FBakI7UUFDQyxLQUFBLEdBQVEsSUFEVDtPQUFBLE1BQUE7UUFHQyxJQUFHLE1BQU0sQ0FBQyxVQUFQLEtBQXFCLENBQXhCO1VBQ0MsS0FBQSxHQUFRLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQVAsR0FBYSxDQUFkLENBQWdCLENBQUMsTUFEdEM7U0FBQSxNQUFBO1VBR0MsS0FBQSxHQUFRLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQVAsR0FBYSxDQUFkLENBQWdCLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxVQUFQLEdBQWtCLENBQW5CLEVBSDVDO1NBSEQ7O01BUUEsSUFBQSxDQUFLLFNBQUEsR0FBVSxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQTNCLEVBQWtDLEdBQUEsR0FBSSxJQUF0QyxFQUE0QyxFQUFBLEdBQUcsSUFBL0M7TUFDQSxJQUFBLENBQUssTUFBTSxDQUFDLE9BQVosRUFBcUIsR0FBQSxHQUFJLElBQXpCLEVBQStCLEVBQUEsR0FBRyxJQUFsQztNQUNBLFNBQUEsQ0FBVSxLQUFWLEVBQWdCLE1BQWhCO01BQ0EsSUFBQSxDQUFLLE9BQUw7TUFDQSxJQUFBLENBQUssS0FBTCxFQUFZLElBQUEsR0FBSyxJQUFqQixFQUF1QixHQUFBLEdBQUksSUFBM0I7TUFFQSxHQUFBLENBQUE7YUFDQSxJQUFDLENBQUEsUUFBRCxDQUFVLEtBQVY7SUE3Q007O0lBK0NQLE9BQVUsQ0FBQSxDQUFBO0FBQ1gsVUFBQSxNQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsT0FBQSxFQUFBLEdBQUEsRUFBQTtNQUFFLFFBQUEsQ0FBQTtNQUNBLElBQUEsQ0FBSyxPQUFMO01BQ0EsUUFBQSxDQUFTLElBQUEsR0FBSyxHQUFkO01BQ0EsT0FBQSxHQUFhLElBQUMsQ0FBQSxPQUFKLEdBQWlCLFVBQWpCLEdBQWlDO01BQzNDLE1BQUEsR0FBWSxJQUFDLENBQUEsT0FBSixHQUFrQixVQUFsQixHQUFrQztBQUUzQztBQUFBO01BQUEsS0FBQSxxQ0FBQTs7UUFDQyxJQUFBLENBQUssT0FBTyxDQUFDLENBQUQsQ0FBWixFQUFnQixJQUFBLEdBQUssQ0FBQyxDQUFBLEdBQUUsQ0FBSCxDQUFyQixFQUEyQixJQUFBLEdBQUssR0FBaEM7cUJBQ0EsSUFBQSxDQUFLLE1BQU0sQ0FBQyxDQUFELENBQVgsRUFBZSxJQUFBLEdBQUssSUFBcEIsRUFBeUIsSUFBQSxHQUFLLENBQUMsQ0FBQSxHQUFFLENBQUgsQ0FBOUI7TUFGRCxDQUFBOztJQVBTOztJQVdWLElBQU8sQ0FBQSxDQUFBO2FBQUcsSUFBQyxDQUFBLE9BQUQsR0FBVyxDQUFJLElBQUMsQ0FBQTtJQUFuQjs7SUFFUCxRQUFXLENBQUMsS0FBRCxDQUFBO0FBQ1osVUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBO01BQUUsS0FBSyxDQUFDLE1BQU4sQ0FBYSxLQUFiO01BQ0EsTUFBQSxDQUFPLE9BQVA7TUFDQSxDQUFBLEdBQUksT0FBQSxDQUFRLEtBQVI7TUFDSixJQUFBLENBQUE7TUFDQSxJQUFHLElBQUMsQ0FBQSxPQUFKO1FBQ0MsU0FBQSxDQUFVLENBQVYsRUFBYSxJQUFBLEdBQUssQ0FBbEI7UUFDQSxLQUFBLENBQU0sQ0FBTixFQUFTLENBQUMsQ0FBVixFQUZEOztNQUdBLFFBQUEsQ0FBUyxNQUFUO01BQ0EsUUFBQSxDQUFBO01BQ0EsQ0FBQSxHQUFJLElBQUEsR0FBTztNQUNYLENBQUEsR0FBSSxJQUFBLEdBQU87TUFDWCxJQUFBLENBQUssT0FBTDtNQUNBLElBQUEsQ0FBSyxDQUFMLEVBQVEsR0FBQSxHQUFJLElBQVosRUFBa0IsQ0FBbEIsRUFBcUIsSUFBQSxHQUFPLENBQTVCO01BQ0EsSUFBQSxDQUFLLE9BQUw7TUFDQSxJQUFBLENBQUssQ0FBTCxFQUFRLEdBQUEsR0FBSSxJQUFaLEVBQWtCLENBQWxCLEVBQXFCLElBQUEsR0FBTyxDQUE1QjtNQUNBLElBQUcsQ0FBQSxHQUFJLENBQVA7UUFDQyxJQUFBLENBQUssT0FBTDtRQUNBLElBQUEsQ0FBSyxDQUFMLEVBQVEsR0FBQSxHQUFJLElBQUosR0FBVyxDQUFuQixFQUFzQixDQUF0QixFQUF5QixDQUF6QixFQUZEO09BQUEsTUFBQTtRQUlDLElBQUEsQ0FBSyxPQUFMO1FBQ0EsSUFBQSxDQUFLLENBQUwsRUFBUSxHQUFBLEdBQUksSUFBWixFQUFrQixDQUFsQixFQUFxQixDQUFDLENBQXRCLEVBTEQ7O2FBTUEsR0FBQSxDQUFBO0lBdEJVOztFQXBITDs7RUE0SU4sT0FBQSxHQUFVLENBQUMsS0FBRCxDQUFBLEdBQUE7QUFDWCxRQUFBLEtBQUEsRUFBQSxDQUFBLEVBQUE7SUFBRSxLQUFLLENBQUMsTUFBTixDQUFhLEtBQWI7SUFDQSxLQUFBLEdBQVE7SUFDUixJQUFHLEtBQUssQ0FBQyxDQUFELENBQUwsS0FBVSxHQUFiO01BQXNCLENBQUEsR0FBSSxNQUExQjtLQUFBLE1BQUE7TUFDSyxDQUFBLEdBQUksSUFBSSxDQUFDLEdBQUwsQ0FBUyxLQUFULEVBRFQ7O0lBRUEsSUFBRyxDQUFBLEdBQUUsS0FBTDtNQUFnQixDQUFBLEdBQUksTUFBcEI7O0lBQ0EsR0FBQSxHQUFNLElBQUEsQ0FBSyxDQUFMLEVBQVEsQ0FBQSxHQUFFLElBQVYsRUFBZ0IsQ0FBQSxHQUFFLEtBQWxCO0lBQ04saUJBQVUsT0FBUCxTQUFIO01BQXFCLEdBQUEsR0FBTSxDQUFDLElBQTVCOztXQUNBLEtBQUssQ0FBQyxPQUFOLENBQWMsSUFBSSxDQUFDLEtBQUwsQ0FBVyxHQUFYLENBQWQ7RUFSUzs7RUFTVixHQUFBLENBQUksQ0FBQSxHQUFFLElBQU4sRUFBVyxPQUFBLENBQVEsTUFBUixDQUFYOztFQUNBLEdBQUEsQ0FBSSxDQUFBLEdBQUUsSUFBTixFQUFXLE9BQUEsQ0FBUSxNQUFSLENBQVg7O0VBQ0EsR0FBQSxDQUFJLENBQUEsR0FBRSxJQUFOLEVBQVcsT0FBQSxDQUFRLE1BQVIsQ0FBWDs7RUFDQSxHQUFBLENBQUksSUFBSixFQUFTLE9BQUEsQ0FBUSxLQUFSLENBQVQ7O0VBQ0EsR0FBQSxDQUFJLENBQUosRUFBTSxPQUFBLENBQVEsR0FBUixDQUFOOztFQUNBLEdBQUEsQ0FBSSxDQUFDLElBQUwsRUFBVSxPQUFBLENBQVEsTUFBUixDQUFWOztFQUNBLEdBQUEsQ0FBSSxDQUFDLENBQUQsR0FBRyxJQUFQLEVBQVksT0FBQSxDQUFRLEtBQVIsQ0FBWiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7YXNzLGxlcnAscGFyYW0scmFuZ2V9IGZyb20gJy4uL2pzL3V0aWxzLmpzJ1xyXG5pbXBvcnQge1NxdWFyZX0gZnJvbSAnLi4vanMvc3F1YXJlLmpzJ1xyXG5pbXBvcnQge0J1dHRvbn0gZnJvbSAnLi4vanMvYnV0dG9uLmpzJ1xyXG5pbXBvcnQge2Nvb3JkcyxjbGlja1N0cmluZyxnZXRNb3ZlLGdsb2JhbCwgbG9hZFRyZWUsIGZpeFN1cGVyLHRvT2JqZWN0Tm90YXRpb259IGZyb20gJy4uL2pzL2dsb2JhbHMuanMnXHJcblxyXG5TSVpFID0gZ2xvYmFsLlNJWkVcclxuXHJcbmV4cG9ydCBjbGFzcyBCb2FyZFxyXG5cdGNvbnN0cnVjdG9yOiAtPlxyXG5cdFx0QHNxdWFyZXMgPSBbXVxyXG5cdFx0QGNsaWNrZWRTcXVhcmVzID0gW11cclxuXHRcdEBwaWVjZXMgPSBcIlwiXHJcblx0XHRAZmxpcHBlZCA9IGZhbHNlXHJcblx0XHRmb3IgaSBpbiByYW5nZSA2NFxyXG5cdFx0XHRkbyAoaSkgPT4gQHNxdWFyZXMucHVzaCBuZXcgU3F1YXJlIGksID0+IEBjbGljayBpXHJcblx0XHRAc3RhcnQoKVxyXG5cclxuXHRcdEBidXR0b25zID0gW11cclxuXHRcdHgwID0gMS41XHJcblx0XHR4MSA9IDMuNVxyXG5cdFx0eDIgPSA1LjVcclxuXHRcdHgzID0gNy41XHJcblx0XHRAYnV0dG9ucy5wdXNoIG5ldyBCdXR0b24geDAqU0laRSwgOS41KlNJWkUsICd1bmRvJywgICAgPT4gY2xpY2tTdHJpbmcgJ3VuZG8nXHJcblx0XHQjQGJ1dHRvbnMucHVzaCBuZXcgQnV0dG9uIHgwKlNJWkUsIDkuNSpTSVpFLCAnZmlyc3QnLCAgICA9PiBjbGlja1N0cmluZyAnZmlyc3QnXHJcblx0XHQjQGJ1dHRvbnMucHVzaCBuZXcgQnV0dG9uIHgxKlNJWkUsIDkuNSpTSVpFLCAnbW92ZSAtMScsICA9PiBjbGlja1N0cmluZyAncHJldidcclxuXHRcdCNAYnV0dG9ucy5wdXNoIG5ldyBCdXR0b24geDIqU0laRSwgOS41KlNJWkUsICdtb3ZlICsxJywgID0+IGNsaWNrU3RyaW5nICduZXh0J1xyXG5cdFx0I0BidXR0b25zLnB1c2ggbmV3IEJ1dHRvbiB4MypTSVpFLCA5LjUqU0laRSwgJ2xhc3QnLCAgICAgPT4gY2xpY2tTdHJpbmcgJ2xhc3QnXHJcblxyXG5cdFx0QGJ1dHRvbnMucHVzaCBuZXcgQnV0dG9uIHgwKlNJWkUsIDEwLjUqU0laRSwgJ2ZsaXAnLCAgICA9PiBjbGlja1N0cmluZyAnZmxpcCdcclxuXHRcdCNAYnV0dG9ucy5wdXNoIG5ldyBCdXR0b24geDEqU0laRSwgMTAuNSpTSVpFLCAnZ2FtZSAtMScsID0+IGNsaWNrU3RyaW5nICdwZ3VwJ1xyXG5cdFx0I0BidXR0b25zLnB1c2ggbmV3IEJ1dHRvbiB4MipTSVpFLCAxMC41KlNJWkUsICdnYW1lICsxJywgPT4gY2xpY2tTdHJpbmcgJ3BnZG4nXHJcblx0XHRAYnV0dG9ucy5wdXNoIG5ldyBCdXR0b24geDMqU0laRSwgMTAuNSpTSVpFLCAnbGluaycsICAgID0+IGNsaWNrU3RyaW5nICdsaW5rJ1xyXG5cdHN0YXJ0IDogPT5cclxuXHRcdEBwaWVjZXMgPSBcIlJOQlFLQk5SUFBQUFBQUFAzMzMzMzMzMzQ0NDQ0NDQ0NTU1NTU1NTU2NjY2NjY2NnBwcHBwcHBwcm5icWtibnJcIlxyXG5cclxuXHRjbGljayA6IChpKSA9PlxyXG5cdFx0aWYgQGNsaWNrZWRTcXVhcmVzLmxlbmd0aCA9PSAwXHJcblx0XHRcdGlmIHRydWUgIyBwasOkcyBhdiByw6R0dCBmw6RyZ1xyXG5cdFx0XHRcdEBjbGlja2VkU3F1YXJlcy5wdXNoIGlcclxuXHRcdGVsc2UgaWYgQGNsaWNrZWRTcXVhcmVzLmxlbmd0aCA9PSAxXHJcblx0XHRcdGlmIGk9PUBjbGlja2VkU3F1YXJlc1swXVxyXG5cdFx0XHRcdEBjbGlja2VkU3F1YXJlcyA9IFtdXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRAY2xpY2tlZFNxdWFyZXMucHVzaCBpXHJcblx0XHRcdFx0bW92ZSA9IHRvT2JqZWN0Tm90YXRpb24gQGNsaWNrZWRTcXVhcmVzWzBdLEBjbGlja2VkU3F1YXJlc1sxXVxyXG5cdFx0XHRcdEBjbGlja2VkU3F1YXJlcyA9IFtdXHJcblx0XHRcdFx0Y29uc29sZS5sb2cgbW92ZVxyXG5cdFx0XHRcdGdsb2JhbC5jaGVzcy5tb3ZlIG1vdmVcclxuXHRcdFx0XHRjb25zb2xlLmxvZyBnbG9iYWwuY2hlc3MuaGlzdG9yeSgpXHJcblxyXG5cdFx0ZWxzZVxyXG5cdFx0XHRAY2xpY2tlZFNxdWFyZXMgPSBbaV1cclxuXHRcdGNvbnNvbGUubG9nICdzcWNsaWNrJyxAY2xpY2tlZFNxdWFyZXNcclxuXHJcblx0bW92ZSA6IChpKSA9PlxyXG5cdFx0cGFyYW0uSW50ZWdlciBpXHJcblx0XHRjb25zb2xlLmxvZyAnbW92ZScsaVxyXG5cdFx0bSA9IGdsb2JhbC5tb3Zlc1tnbG9iYWwuaW5kZXgtMV1cclxuXHRcdGlmIGk9PTAgdGhlbiBrZXkgPSBtLnVjaSBlbHNlIGtleSA9IG0uc3VwZXJpb3JzW2ktMV1cclxuXHRcdEBwaWVjZXMgPSBtYWtlTW92ZSBrZXksIGdsb2JhbC5waWVjZXNzW2dsb2JhbC5pbmRleC0xXVxyXG5cdFx0Z2xvYmFsLnN1cGVySW5kZXggPSBpKzFcclxuXHRcdGZpeFN1cGVyIDBcclxuXHJcblx0ZHJhdyA6ID0+XHJcblxyXG5cdFx0Zm9yIGJ1dHRvbiBpbiBAYnV0dG9uc1xyXG5cdFx0XHRidXR0b24uZHJhdygpXHJcblxyXG5cdFx0aWYgbm90IGdsb2JhbC50cmVlIHRoZW4gcmV0dXJuXHJcblxyXG5cdFx0ZmlsbCAnd2hpdGUnXHJcblx0XHR0ZXh0U2l6ZSBTSVpFKjAuM1xyXG5cclxuXHRcdHB1c2goKVxyXG5cdFx0dGV4dEFsaWduIExFRlQsQ0VOVEVSXHJcblx0XHR0ZXh0IGdsb2JhbC5maWxlbmFtZSwwLjA1KlNJWkUsIDAuMypTSVpFXHJcblx0XHRwb3AoKVxyXG5cclxuXHRcdGZvciBpIGluIHJhbmdlIDhcclxuXHRcdFx0Zm9yIGogaW4gcmFuZ2UgOFxyXG5cdFx0XHRcdHBpZWNlID0gZ2xvYmFsLmNoZXNzLmJvYXJkKClbNy1pXVtqXSAjIHtzcXVhcmUsIHR5cGUsIGNvbG9yfVxyXG5cdFx0XHRcdEBzcXVhcmVzW2kqOCtqXS5kcmF3IHBpZWNlLCBAZmxpcHBlZCwgaSo4K2o9PUBjbGlja2VkU3F1YXJlc1swXVxyXG5cclxuXHRcdHN0cm9rZSAnYmxhY2snXHJcblx0XHRub0ZpbGwoKVxyXG5cdFx0cmVjdCBTSVpFKjQuNSxTSVpFKjQuNSxTSVpFKjgsU0laRSo4XHJcblxyXG5cdFx0QGxpdHRlcmEoKVxyXG5cclxuXHRcdHB1c2goKVxyXG5cdFx0dGV4dEFsaWduIENFTlRFUixDRU5URVJcclxuXHRcdGlmIGdsb2JhbC5pbmRleCA+IDBcclxuXHRcdFx0dGV4dCAnbW92ZTogJyArICgxK2dsb2JhbC5pbmRleC8vMikgKyBcIkJXXCJbZ2xvYmFsLmluZGV4JTJdKyBcIiBvZiBcIisgKDErZ2xvYmFsLm1vdmVzLmxlbmd0aC8vMiksIDQuNSpTSVpFLCAxMCpTSVpFXHJcblx0XHRpZiBnbG9iYWwuaW5kZXg9PTBcclxuXHRcdFx0c2NvcmUgPSAnMCdcclxuXHRcdGVsc2UgXHJcblx0XHRcdGlmIGdsb2JhbC5zdXBlckluZGV4ID09IDBcclxuXHRcdFx0XHRzY29yZSA9IGdsb2JhbC5tb3Zlc1tnbG9iYWwuaW5kZXgtMV0uc2NvcmVcclxuXHRcdFx0ZWxzZSBcclxuXHRcdFx0XHRzY29yZSA9IGdsb2JhbC5tb3Zlc1tnbG9iYWwuaW5kZXgtMV0uc2NvcmVzW2dsb2JhbC5zdXBlckluZGV4LTFdXHJcblxyXG5cdFx0dGV4dCAnZGVwdGg6ICcrZ2xvYmFsLnRyZWUuZGVwdGgsIDEuNSpTSVpFLCAxMCpTSVpFXHJcblx0XHR0ZXh0IGdsb2JhbC52ZXJzaW9uLCA3LjUqU0laRSwgMTAqU0laRVxyXG5cdFx0dGV4dEFsaWduIFJJR0hULENFTlRFUlxyXG5cdFx0ZmlsbCAnd2hpdGUnXHJcblx0XHR0ZXh0IHNjb3JlLCAxMC4xKlNJWkUsIDAuMypTSVpFXHJcblxyXG5cdFx0cG9wKClcclxuXHRcdEBkcmF3QmFycyBzY29yZVxyXG5cclxuXHRsaXR0ZXJhIDogPT5cclxuXHRcdG5vU3Ryb2tlKClcclxuXHRcdGZpbGwgJ2JsYWNrJ1xyXG5cdFx0dGV4dFNpemUgU0laRSowLjNcclxuXHRcdGxldHRlcnMgPSBpZiBAZmxpcHBlZCB0aGVuIFwiaGdmZWRjYmFcIiBlbHNlIFwiYWJjZGVmZ2hcIlxyXG5cdFx0ZGlnaXRzID0gaWYgQGZsaXBwZWQgdGhlbiAgXCIxMjM0NTY3OFwiIGVsc2UgXCI4NzY1NDMyMVwiXHJcblxyXG5cdFx0Zm9yIGkgaW4gcmFuZ2UgOFxyXG5cdFx0XHR0ZXh0IGxldHRlcnNbaV0sU0laRSooaSsxKSxTSVpFKjguOFxyXG5cdFx0XHR0ZXh0IGRpZ2l0c1tpXSxTSVpFKjAuMTUsU0laRSooaSsxKVxyXG5cclxuXHRmbGlwIDogPT4gQGZsaXBwZWQgPSBub3QgQGZsaXBwZWRcclxuXHJcblx0ZHJhd0JhcnMgOiAoc2NvcmUpIC0+XHJcblx0XHRwYXJhbS5TdHJpbmcgc2NvcmVcclxuXHRcdHN0cm9rZSAnYmxhY2snIFxyXG5cdFx0aCA9IGNhbGNCYXIgc2NvcmVcclxuXHRcdHB1c2goKVxyXG5cdFx0aWYgQGZsaXBwZWRcclxuXHRcdFx0dHJhbnNsYXRlIDAsIFNJWkUqOVxyXG5cdFx0XHRzY2FsZSAxLCAtMVxyXG5cdFx0cmVjdE1vZGUgQ09STkVSXHJcblx0XHRub1N0cm9rZSgpXHJcblx0XHR4ID0gMC4zNSAqIFNJWkVcclxuXHRcdHcgPSAwLjEwICogU0laRVxyXG5cdFx0ZmlsbCAnYmxhY2snXHJcblx0XHRyZWN0IHgsIDAuNSpTSVpFLCB3LCBTSVpFICogNFxyXG5cdFx0ZmlsbCAnd2hpdGUnXHJcblx0XHRyZWN0IHgsIDQuNSpTSVpFLCB3LCBTSVpFICogNFxyXG5cdFx0aWYgaCA+IDBcclxuXHRcdFx0ZmlsbCAnd2hpdGUnXHJcblx0XHRcdHJlY3QgeCwgNC41KlNJWkUgLSBoLCB3LCBoXHJcblx0XHRlbHNlXHJcblx0XHRcdGZpbGwgJ2JsYWNrJ1xyXG5cdFx0XHRyZWN0IHgsIDQuNSpTSVpFLCB3LCAtaFxyXG5cdFx0cG9wKClcclxuXHJcblx0Y2FsY0JhciA9IChzY29yZSkgPT5cclxuXHRcdHBhcmFtLlN0cmluZyBzY29yZVxyXG5cdFx0TElNSVQgPSAyMDAwXHJcblx0XHRpZiBzY29yZVswXT09JyMnIHRoZW4gZCA9IExJTUlUXHJcblx0XHRlbHNlIGQgPSBNYXRoLmFicyBzY29yZVxyXG5cdFx0aWYgZD5MSU1JVCB0aGVuIGQgPSBMSU1JVFxyXG5cdFx0cmVzID0gbGVycCAwLCA0KlNJWkUsIGQvTElNSVRcclxuXHRcdGlmIFwiLVwiIGluIHNjb3JlIHRoZW4gcmVzID0gLXJlc1xyXG5cdFx0cGFyYW0uSW50ZWdlciBNYXRoLnJvdW5kIHJlc1xyXG5cdGFzcyA0KlNJWkUsY2FsY0JhciBcIjIxMDBcIlxyXG5cdGFzcyA0KlNJWkUsY2FsY0JhciBcIjIwMDBcIlxyXG5cdGFzcyAyKlNJWkUsY2FsY0JhciBcIjEwMDBcIlxyXG5cdGFzcyBTSVpFLGNhbGNCYXIgXCI1MDBcIlxyXG5cdGFzcyAwLGNhbGNCYXIgXCIxXCJcclxuXHRhc3MgLVNJWkUsY2FsY0JhciBcIi01MDBcIlxyXG5cdGFzcyAtNCpTSVpFLGNhbGNCYXIgXCIjLTFcIlxyXG4iXX0=
//# sourceURL=c:\github\2023-019-ChessTree\coffee\board.coffee