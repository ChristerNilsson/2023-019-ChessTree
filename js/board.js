// Generated by CoffeeScript 2.5.1
var SIZE,
  indexOf = [].indexOf;

import _ from 'https://cdn.skypack.dev/lodash';

import {
  ass,
  lerp,
  param,
  range,
  hexToBase64
} from '../js/utils.js';

import cryptoJs from 'https://cdn.skypack.dev/crypto-js';

import {
  Square
} from '../js/square.js';

import {
  Button
} from '../js/button.js';

import {
  coords,
  clickString,
  getMove,
  global,
  loadTree,
  fixSuper,
  toObjectNotation,
  toUCI
} from '../js/globals.js';

import {
  dumpState,
  showChildren
} from '../js/globals.js';

SIZE = global.SIZE;

export var Board = (function() {
  var calcBar;

  class Board {
    constructor() {
      var i, k, len, ref, x0, x1, x2, x3;
      // start : =>
      // 	@pieces = "RNBQKBNRPPPPPPPP33333333444444445555555566666666pppppppprnbqkbnr"
      this.click = this.click.bind(this);
      // move : (i) =>
      // 	param.Integer i
      // 	console.log 'move',i
      // 	m = global.moves[global.index-1]
      // 	if i==0 then key = m.uci else key = m.superiors[i-1]
      // 	@pieces = makeMove key, global.piecess[global.index-1]
      // 	global.superIndex = i+1
      // 	fixSuper 0
      this.draw = this.draw.bind(this);
      this.littera = this.littera.bind(this);
      this.flip = this.flip.bind(this);
      this.squares = [];
      this.clickedSquares = [];
      this.pieces = "";
      this.flipped = false;
      ref = range(64);
      for (k = 0, len = ref.length; k < len; k++) {
        i = ref[k];
        ((i) => {
          return this.squares.push(new Square(i, () => {
            return this.click(i);
          }));
        })(i);
      }
      // @start()
      this.buttons = [];
      x0 = 1.5;
      x1 = 3.5;
      x2 = 5.5;
      x3 = 7.5;
      this.buttons.push(new Button(x0 * SIZE, 9.5 * SIZE, 'undo', () => {
        return clickString('undo');
      }));
      //@buttons.push new Button x0*SIZE, 9.5*SIZE, 'first',    => clickString 'first'
      //@buttons.push new Button x1*SIZE, 9.5*SIZE, 'move -1',  => clickString 'prev'
      //@buttons.push new Button x2*SIZE, 9.5*SIZE, 'move +1',  => clickString 'next'
      //@buttons.push new Button x3*SIZE, 9.5*SIZE, 'last',     => clickString 'last'
      this.buttons.push(new Button(x0 * SIZE, 10.5 * SIZE, 'flip', () => {
        return clickString('flip');
      }));
      //@buttons.push new Button x1*SIZE, 10.5*SIZE, 'game -1', => clickString 'pgup'
      //@buttons.push new Button x2*SIZE, 10.5*SIZE, 'game +1', => clickString 'pgdn'
      this.buttons.push(new Button(x3 * SIZE, 10.5 * SIZE, 'link', () => {
        return clickString('link');
      }));
    }

    click(i) {
      var move, uci;
      if (this.clickedSquares.length === 0) {
        if (true) { // pjäs av rätt färg
          this.clickedSquares.push(i);
        }
      } else if (this.clickedSquares.length === 1) {
        if (i === this.clickedSquares[0]) {
          this.clickedSquares = [];
        } else {
          this.clickedSquares.push(i);
          move = toObjectNotation(this.clickedSquares); //[0],@clickedSquares[1]]
          uci = toUCI(this.clickedSquares); //[0],@clickedSquares[1]
          this.clickedSquares = [];
          console.log(move);
          global.chess.move(move);
          console.log('click', global.currNode, uci);
          global.stack.push(global.currNode);
          global.currNode = global.currNode[uci];
          dumpState();
          showChildren();
        }
      } else {
        // coffee  lSpemS5l rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3 0 1
        // python: lSpemS5l rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3 0 1

        //console.log 'history',global.chess.history()
        this.clickedSquares = [i];
      }
      return console.log('sqclick', this.clickedSquares);
    }

    draw() {
      var button, i, j, k, l, len, len1, len2, m, piece, ref, ref1, ref2, score;
      ref = this.buttons;
      for (k = 0, len = ref.length; k < len; k++) {
        button = ref[k];
        button.draw();
      }
      if (!global.tree) {
        return;
      }
      fill('white');
      textSize(SIZE * 0.3);
      push();
      textAlign(LEFT, CENTER);
      text(global.filename, 0.05 * SIZE, 0.3 * SIZE);
      pop();
      ref1 = range(8);
      for (l = 0, len1 = ref1.length; l < len1; l++) {
        i = ref1[l];
        ref2 = range(8);
        for (m = 0, len2 = ref2.length; m < len2; m++) {
          j = ref2[m];
          piece = global.chess.board()[7 - i][j];
          this.squares[i * 8 + j].draw(piece, this.flipped, i * 8 + j === this.clickedSquares[0]);
        }
      }
      stroke('black');
      noFill();
      rect(SIZE * 4.5, SIZE * 4.5, SIZE * 8, SIZE * 8);
      this.littera();
      push();
      textAlign(CENTER, CENTER);
      if (global.index > 0) {
        text('move: ' + (1 + Math.floor(global.index / 2)) + "BW"[global.index % 2] + " of " + (1 + Math.floor(global.moves.length / 2)), 4.5 * SIZE, 10 * SIZE);
      }
      if (global.index === 0) {
        score = '0';
      } else {
        if (global.superIndex === 0) {
          score = global.moves[global.index - 1].score;
        } else {
          score = global.moves[global.index - 1].scores[global.superIndex - 1];
        }
      }
      text('depth: ' + global.tree.depth, 1.5 * SIZE, 10 * SIZE);
      text(global.version, 7.5 * SIZE, 10 * SIZE);
      textAlign(RIGHT, CENTER);
      fill('white');
      text(score, 10.1 * SIZE, 0.3 * SIZE);
      pop();
      return this.drawBars(score);
    }

    littera() {
      var digits, i, k, len, letters, ref, results;
      noStroke();
      fill('black');
      textSize(SIZE * 0.3);
      letters = this.flipped ? "hgfedcba" : "abcdefgh";
      digits = this.flipped ? "12345678" : "87654321";
      ref = range(8);
      results = [];
      for (k = 0, len = ref.length; k < len; k++) {
        i = ref[k];
        text(letters[i], SIZE * (i + 1), SIZE * 8.8);
        results.push(text(digits[i], SIZE * 0.15, SIZE * (i + 1)));
      }
      return results;
    }

    flip() {
      return this.flipped = !this.flipped;
    }

    drawBars(score) {
      var h, w, x;
      param.String(score);
      stroke('black');
      h = calcBar(score);
      push();
      if (this.flipped) {
        translate(0, SIZE * 9);
        scale(1, -1);
      }
      rectMode(CORNER);
      noStroke();
      x = 0.35 * SIZE;
      w = 0.10 * SIZE;
      fill('black');
      rect(x, 0.5 * SIZE, w, SIZE * 4);
      fill('white');
      rect(x, 4.5 * SIZE, w, SIZE * 4);
      if (h > 0) {
        fill('white');
        rect(x, 4.5 * SIZE - h, w, h);
      } else {
        fill('black');
        rect(x, 4.5 * SIZE, w, -h);
      }
      return pop();
    }

  };

  calcBar = (score) => {
    var LIMIT, d, res;
    param.String(score);
    LIMIT = 2000;
    if (score[0] === '#') {
      d = LIMIT;
    } else {
      d = Math.abs(score);
    }
    if (d > LIMIT) {
      d = LIMIT;
    }
    res = lerp(0, 4 * SIZE, d / LIMIT);
    if (indexOf.call(score, "-") >= 0) {
      res = -res;
    }
    return param.Integer(Math.round(res));
  };

  ass(4 * SIZE, calcBar("2100"));

  ass(4 * SIZE, calcBar("2000"));

  ass(2 * SIZE, calcBar("1000"));

  ass(SIZE, calcBar("500"));

  ass(0, calcBar("1"));

  ass(-SIZE, calcBar("-500"));

  ass(-4 * SIZE, calcBar("#-1"));

  return Board;

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm9hcmQuanMiLCJzb3VyY2VSb290IjoiLi4iLCJzb3VyY2VzIjpbImNvZmZlZVxcYm9hcmQuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBLElBQUE7RUFBQTs7QUFBQSxPQUFPLENBQVAsTUFBQTs7QUFDQSxPQUFBO0VBQVEsR0FBUjtFQUFZLElBQVo7RUFBaUIsS0FBakI7RUFBdUIsS0FBdkI7RUFBNkIsV0FBN0I7Q0FBQSxNQUFBOztBQUNBLE9BQU8sUUFBUCxNQUFBOztBQUNBLE9BQUE7RUFBUSxNQUFSO0NBQUEsTUFBQTs7QUFDQSxPQUFBO0VBQVEsTUFBUjtDQUFBLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLE1BQVI7RUFBZSxXQUFmO0VBQTJCLE9BQTNCO0VBQW1DLE1BQW5DO0VBQTBDLFFBQTFDO0VBQW1ELFFBQW5EO0VBQTRELGdCQUE1RDtFQUE2RSxLQUE3RTtDQUFBLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLFNBQVI7RUFBa0IsWUFBbEI7Q0FBQSxNQUFBOztBQUVBLElBQUEsR0FBTyxNQUFNLENBQUM7O0FBRWQsT0FBQSxJQUFhOzs7RUFBTixNQUFBLE1BQUE7SUFDTixXQUFhLENBQUEsQ0FBQTtBQUNkLFVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsR0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUE7OztVQTJCQyxDQUFBLFlBQUEsQ0FBQSxpQkEzQkQ7Ozs7Ozs7OztVQW1FQyxDQUFBLFdBQUEsQ0FBQTtVQStDQSxDQUFBLGNBQUEsQ0FBQTtVQVdBLENBQUEsV0FBQSxDQUFBO01BN0hDLElBQUMsQ0FBQSxPQUFELEdBQVc7TUFDWCxJQUFDLENBQUEsY0FBRCxHQUFrQjtNQUNsQixJQUFDLENBQUEsTUFBRCxHQUFVO01BQ1YsSUFBQyxDQUFBLE9BQUQsR0FBVztBQUNYO01BQUEsS0FBQSxxQ0FBQTs7UUFDSSxDQUFBLENBQUMsQ0FBRCxDQUFBLEdBQUE7aUJBQU8sSUFBQyxDQUFB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QUFXLE9BQUEsQ0FBUSxNQUFSLENBQVg7O0VBQ0EsR0FBQSxDQUFJLElBQUosRUFBUyxPQUFBLENBQVEsS0FBUixDQUFUOztFQUNBLEdBQUEsQ0FBSSxDQUFKLEVBQU0sT0FBQSxDQUFRLEdBQVIsQ0FBTjs7RUFDQSxHQUFBLENBQUksQ0FBQyxJQUFMLEVBQVUsT0FBQSxDQUFRLE1BQVIsQ0FBVjs7RUFDQSxHQUFBLENBQUksQ0FBQyxDQUFELEdBQUcsSUFBUCxFQUFZLE9BQUEsQ0FBUSxLQUFSLENBQVoiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyAgICAgICAgICAgZnJvbSAnaHR0cHM6Ly9jZG4uc2t5cGFjay5kZXYvbG9kYXNoJ1xyXG5pbXBvcnQge2FzcyxsZXJwLHBhcmFtLHJhbmdlLGhleFRvQmFzZTY0fSBmcm9tICcuLi9qcy91dGlscy5qcydcclxuaW1wb3J0IGNyeXB0b0pzIGZyb20gJ2h0dHBzOi8vY2RuLnNreXBhY2suZGV2L2NyeXB0by1qcydcclxuaW1wb3J0IHtTcXVhcmV9IGZyb20gJy4uL2pzL3NxdWFyZS5qcydcclxuaW1wb3J0IHtCdXR0b259IGZyb20gJy4uL2pzL2J1dHRvbi5qcydcclxuaW1wb3J0IHtjb29yZHMsY2xpY2tTdHJpbmcsZ2V0TW92ZSxnbG9iYWwsbG9hZFRyZWUsZml4U3VwZXIsdG9PYmplY3ROb3RhdGlvbix0b1VDSX0gZnJvbSAnLi4vanMvZ2xvYmFscy5qcydcclxuaW1wb3J0IHtkdW1wU3RhdGUsc2hvd0NoaWxkcmVufSBmcm9tICcuLi9qcy9nbG9iYWxzLmpzJ1xyXG5cclxuU0laRSA9IGdsb2JhbC5TSVpFXHJcblxyXG5leHBvcnQgY2xhc3MgQm9hcmRcclxuXHRjb25zdHJ1Y3RvcjogLT5cclxuXHRcdEBzcXVhcmVzID0gW11cclxuXHRcdEBjbGlja2VkU3F1YXJlcyA9IFtdXHJcblx0XHRAcGllY2VzID0gXCJcIlxyXG5cdFx0QGZsaXBwZWQgPSBmYWxzZVxyXG5cdFx0Zm9yIGkgaW4gcmFuZ2UgNjRcclxuXHRcdFx0ZG8gKGkpID0+IEBzcXVhcmVzLnB1c2ggbmV3IFNxdWFyZSBpLCA9PiBAY2xpY2sgaVxyXG5cdFx0IyBAc3RhcnQoKVxyXG5cclxuXHRcdEBidXR0b25zID0gW11cclxuXHRcdHgwID0gMS41XHJcblx0XHR4MSA9IDMuNVxyXG5cdFx0eDIgPSA1LjVcclxuXHRcdHgzID0gNy41XHJcblx0XHRAYnV0dG9ucy5wdXNoIG5ldyBCdXR0b24geDAqU0laRSwgOS41KlNJWkUsICd1bmRvJywgICAgPT4gY2xpY2tTdHJpbmcgJ3VuZG8nXHJcblx0XHQjQGJ1dHRvbnMucHVzaCBuZXcgQnV0dG9uIHgwKlNJWkUsIDkuNSpTSVpFLCAnZmlyc3QnLCAgICA9PiBjbGlja1N0cmluZyAnZmlyc3QnXHJcblx0XHQjQGJ1dHRvbnMucHVzaCBuZXcgQnV0dG9uIHgxKlNJWkUsIDkuNSpTSVpFLCAnbW92ZSAtMScsICA9PiBjbGlja1N0cmluZyAncHJldidcclxuXHRcdCNAYnV0dG9ucy5wdXNoIG5ldyBCdXR0b24geDIqU0laRSwgOS41KlNJWkUsICdtb3ZlICsxJywgID0+IGNsaWNrU3RyaW5nICduZXh0J1xyXG5cdFx0I0BidXR0b25zLnB1c2ggbmV3IEJ1dHRvbiB4MypTSVpFLCA5LjUqU0laRSwgJ2xhc3QnLCAgICAgPT4gY2xpY2tTdHJpbmcgJ2xhc3QnXHJcblxyXG5cdFx0QGJ1dHRvbnMucHVzaCBuZXcgQnV0dG9uIHgwKlNJWkUsIDEwLjUqU0laRSwgJ2ZsaXAnLCAgICA9PiBjbGlja1N0cmluZyAnZmxpcCdcclxuXHRcdCNAYnV0dG9ucy5wdXNoIG5ldyBCdXR0b24geDEqU0laRSwgMTAuNSpTSVpFLCAnZ2FtZSAtMScsID0+IGNsaWNrU3RyaW5nICdwZ3VwJ1xyXG5cdFx0I0BidXR0b25zLnB1c2ggbmV3IEJ1dHRvbiB4MipTSVpFLCAxMC41KlNJWkUsICdnYW1lICsxJywgPT4gY2xpY2tTdHJpbmcgJ3BnZG4nXHJcblx0XHRAYnV0dG9ucy5wdXNoIG5ldyBCdXR0b24geDMqU0laRSwgMTAuNSpTSVpFLCAnbGluaycsICAgID0+IGNsaWNrU3RyaW5nICdsaW5rJ1xyXG5cclxuXHQjIHN0YXJ0IDogPT5cclxuXHQjIFx0QHBpZWNlcyA9IFwiUk5CUUtCTlJQUFBQUFBQUDMzMzMzMzMzNDQ0NDQ0NDQ1NTU1NTU1NTY2NjY2NjY2cHBwcHBwcHBybmJxa2JuclwiXHJcblxyXG5cdGNsaWNrIDogKGkpID0+XHJcblx0XHRpZiBAY2xpY2tlZFNxdWFyZXMubGVuZ3RoID09IDBcclxuXHRcdFx0aWYgdHJ1ZSAjIHBqw6RzIGF2IHLDpHR0IGbDpHJnXHJcblx0XHRcdFx0QGNsaWNrZWRTcXVhcmVzLnB1c2ggaVxyXG5cdFx0ZWxzZSBpZiBAY2xpY2tlZFNxdWFyZXMubGVuZ3RoID09IDFcclxuXHRcdFx0aWYgaT09QGNsaWNrZWRTcXVhcmVzWzBdXHJcblx0XHRcdFx0QGNsaWNrZWRTcXVhcmVzID0gW11cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdEBjbGlja2VkU3F1YXJlcy5wdXNoIGlcclxuXHRcdFx0XHRtb3ZlID0gdG9PYmplY3ROb3RhdGlvbiBAY2xpY2tlZFNxdWFyZXMgI1swXSxAY2xpY2tlZFNxdWFyZXNbMV1dXHJcblx0XHRcdFx0dWNpID0gdG9VQ0kgQGNsaWNrZWRTcXVhcmVzICNbMF0sQGNsaWNrZWRTcXVhcmVzWzFdXHJcblx0XHRcdFx0QGNsaWNrZWRTcXVhcmVzID0gW11cclxuXHRcdFx0XHRjb25zb2xlLmxvZyBtb3ZlXHJcblx0XHRcdFx0Z2xvYmFsLmNoZXNzLm1vdmUgbW92ZVxyXG5cclxuXHRcdFx0XHRjb25zb2xlLmxvZyAnY2xpY2snLGdsb2JhbC5jdXJyTm9kZSx1Y2lcclxuXHRcdFx0XHRnbG9iYWwuc3RhY2sucHVzaCBnbG9iYWwuY3Vyck5vZGVcclxuXHRcdFx0XHRnbG9iYWwuY3Vyck5vZGUgPSBnbG9iYWwuY3Vyck5vZGVbdWNpXVxyXG5cdFx0XHRcdGR1bXBTdGF0ZSgpXHJcblxyXG5cdFx0XHRcdHNob3dDaGlsZHJlbigpXHJcblxyXG5cdFx0XHRcdCMgY29mZmVlICBsU3BlbVM1bCBybmJxa2Juci9wcHBwcHBwcC84LzgvNFAzLzgvUFBQUDFQUFAvUk5CUUtCTlIgYiBLUWtxIGUzIDAgMVxyXG5cdFx0XHRcdCMgcHl0aG9uOiBsU3BlbVM1bCBybmJxa2Juci9wcHBwcHBwcC84LzgvNFAzLzgvUFBQUDFQUFAvUk5CUUtCTlIgYiBLUWtxIGUzIDAgMVxyXG5cclxuXHRcdFx0XHQjY29uc29sZS5sb2cgJ2hpc3RvcnknLGdsb2JhbC5jaGVzcy5oaXN0b3J5KClcclxuXHJcblx0XHRlbHNlXHJcblx0XHRcdEBjbGlja2VkU3F1YXJlcyA9IFtpXVxyXG5cdFx0Y29uc29sZS5sb2cgJ3NxY2xpY2snLEBjbGlja2VkU3F1YXJlc1xyXG5cclxuXHQjIG1vdmUgOiAoaSkgPT5cclxuXHQjIFx0cGFyYW0uSW50ZWdlciBpXHJcblx0IyBcdGNvbnNvbGUubG9nICdtb3ZlJyxpXHJcblx0IyBcdG0gPSBnbG9iYWwubW92ZXNbZ2xvYmFsLmluZGV4LTFdXHJcblx0IyBcdGlmIGk9PTAgdGhlbiBrZXkgPSBtLnVjaSBlbHNlIGtleSA9IG0uc3VwZXJpb3JzW2ktMV1cclxuXHQjIFx0QHBpZWNlcyA9IG1ha2VNb3ZlIGtleSwgZ2xvYmFsLnBpZWNlc3NbZ2xvYmFsLmluZGV4LTFdXHJcblx0IyBcdGdsb2JhbC5zdXBlckluZGV4ID0gaSsxXHJcblx0IyBcdGZpeFN1cGVyIDBcclxuXHJcblx0ZHJhdyA6ID0+XHJcblxyXG5cdFx0Zm9yIGJ1dHRvbiBpbiBAYnV0dG9uc1xyXG5cdFx0XHRidXR0b24uZHJhdygpXHJcblxyXG5cdFx0aWYgbm90IGdsb2JhbC50cmVlIHRoZW4gcmV0dXJuXHJcblxyXG5cdFx0ZmlsbCAnd2hpdGUnXHJcblx0XHR0ZXh0U2l6ZSBTSVpFKjAuM1xyXG5cclxuXHRcdHB1c2goKVxyXG5cdFx0dGV4dEFsaWduIExFRlQsQ0VOVEVSXHJcblx0XHR0ZXh0IGdsb2JhbC5maWxlbmFtZSwwLjA1KlNJWkUsIDAuMypTSVpFXHJcblx0XHRwb3AoKVxyXG5cclxuXHRcdGZvciBpIGluIHJhbmdlIDhcclxuXHRcdFx0Zm9yIGogaW4gcmFuZ2UgOFxyXG5cdFx0XHRcdHBpZWNlID0gZ2xvYmFsLmNoZXNzLmJvYXJkKClbNy1pXVtqXSAjIHtzcXVhcmUsIHR5cGUsIGNvbG9yfVxyXG5cdFx0XHRcdEBzcXVhcmVzW2kqOCtqXS5kcmF3IHBpZWNlLCBAZmxpcHBlZCwgaSo4K2o9PUBjbGlja2VkU3F1YXJlc1swXVxyXG5cclxuXHRcdHN0cm9rZSAnYmxhY2snXHJcblx0XHRub0ZpbGwoKVxyXG5cdFx0cmVjdCBTSVpFKjQuNSxTSVpFKjQuNSxTSVpFKjgsU0laRSo4XHJcblxyXG5cdFx0QGxpdHRlcmEoKVxyXG5cclxuXHRcdHB1c2goKVxyXG5cdFx0dGV4dEFsaWduIENFTlRFUixDRU5URVJcclxuXHRcdGlmIGdsb2JhbC5pbmRleCA+IDBcclxuXHRcdFx0dGV4dCAnbW92ZTogJyArICgxK2dsb2JhbC5pbmRleC8vMikgKyBcIkJXXCJbZ2xvYmFsLmluZGV4JTJdKyBcIiBvZiBcIisgKDErZ2xvYmFsLm1vdmVzLmxlbmd0aC8vMiksIDQuNSpTSVpFLCAxMCpTSVpFXHJcblx0XHRpZiBnbG9iYWwuaW5kZXg9PTBcclxuXHRcdFx0c2NvcmUgPSAnMCdcclxuXHRcdGVsc2UgXHJcblx0XHRcdGlmIGdsb2JhbC5zdXBlckluZGV4ID09IDBcclxuXHRcdFx0XHRzY29yZSA9IGdsb2JhbC5tb3Zlc1tnbG9iYWwuaW5kZXgtMV0uc2NvcmVcclxuXHRcdFx0ZWxzZSBcclxuXHRcdFx0XHRzY29yZSA9IGdsb2JhbC5tb3Zlc1tnbG9iYWwuaW5kZXgtMV0uc2NvcmVzW2dsb2JhbC5zdXBlckluZGV4LTFdXHJcblxyXG5cdFx0dGV4dCAnZGVwdGg6ICcrZ2xvYmFsLnRyZWUuZGVwdGgsIDEuNSpTSVpFLCAxMCpTSVpFXHJcblx0XHR0ZXh0IGdsb2JhbC52ZXJzaW9uLCA3LjUqU0laRSwgMTAqU0laRVxyXG5cdFx0dGV4dEFsaWduIFJJR0hULENFTlRFUlxyXG5cdFx0ZmlsbCAnd2hpdGUnXHJcblx0XHR0ZXh0IHNjb3JlLCAxMC4xKlNJWkUsIDAuMypTSVpFXHJcblxyXG5cdFx0cG9wKClcclxuXHRcdEBkcmF3QmFycyBzY29yZVxyXG5cclxuXHRsaXR0ZXJhIDogPT5cclxuXHRcdG5vU3Ryb2tlKClcclxuXHRcdGZpbGwgJ2JsYWNrJ1xyXG5cdFx0dGV4dFNpemUgU0laRSowLjNcclxuXHRcdGxldHRlcnMgPSBpZiBAZmxpcHBlZCB0aGVuIFwiaGdmZWRjYmFcIiBlbHNlIFwiYWJjZGVmZ2hcIlxyXG5cdFx0ZGlnaXRzID0gaWYgQGZsaXBwZWQgdGhlbiAgXCIxMjM0NTY3OFwiIGVsc2UgXCI4NzY1NDMyMVwiXHJcblxyXG5cdFx0Zm9yIGkgaW4gcmFuZ2UgOFxyXG5cdFx0XHR0ZXh0IGxldHRlcnNbaV0sU0laRSooaSsxKSxTSVpFKjguOFxyXG5cdFx0XHR0ZXh0IGRpZ2l0c1tpXSxTSVpFKjAuMTUsU0laRSooaSsxKVxyXG5cclxuXHRmbGlwIDogPT4gQGZsaXBwZWQgPSBub3QgQGZsaXBwZWRcclxuXHJcblx0ZHJhd0JhcnMgOiAoc2NvcmUpIC0+XHJcblx0XHRwYXJhbS5TdHJpbmcgc2NvcmVcclxuXHRcdHN0cm9rZSAnYmxhY2snIFxyXG5cdFx0aCA9IGNhbGNCYXIgc2NvcmVcclxuXHRcdHB1c2goKVxyXG5cdFx0aWYgQGZsaXBwZWRcclxuXHRcdFx0dHJhbnNsYXRlIDAsIFNJWkUqOVxyXG5cdFx0XHRzY2FsZSAxLCAtMVxyXG5cdFx0cmVjdE1vZGUgQ09STkVSXHJcblx0XHRub1N0cm9rZSgpXHJcblx0XHR4ID0gMC4zNSAqIFNJWkVcclxuXHRcdHcgPSAwLjEwICogU0laRVxyXG5cdFx0ZmlsbCAnYmxhY2snXHJcblx0XHRyZWN0IHgsIDAuNSpTSVpFLCB3LCBTSVpFICogNFxyXG5cdFx0ZmlsbCAnd2hpdGUnXHJcblx0XHRyZWN0IHgsIDQuNSpTSVpFLCB3LCBTSVpFICogNFxyXG5cdFx0aWYgaCA+IDBcclxuXHRcdFx0ZmlsbCAnd2hpdGUnXHJcblx0XHRcdHJlY3QgeCwgNC41KlNJWkUgLSBoLCB3LCBoXHJcblx0XHRlbHNlXHJcblx0XHRcdGZpbGwgJ2JsYWNrJ1xyXG5cdFx0XHRyZWN0IHgsIDQuNSpTSVpFLCB3LCAtaFxyXG5cdFx0cG9wKClcclxuXHJcblx0Y2FsY0JhciA9IChzY29yZSkgPT5cclxuXHRcdHBhcmFtLlN0cmluZyBzY29yZVxyXG5cdFx0TElNSVQgPSAyMDAwXHJcblx0XHRpZiBzY29yZVswXT09JyMnIHRoZW4gZCA9IExJTUlUXHJcblx0XHRlbHNlIGQgPSBNYXRoLmFicyBzY29yZVxyXG5cdFx0aWYgZD5MSU1JVCB0aGVuIGQgPSBMSU1JVFxyXG5cdFx0cmVzID0gbGVycCAwLCA0KlNJWkUsIGQvTElNSVRcclxuXHRcdGlmIFwiLVwiIGluIHNjb3JlIHRoZW4gcmVzID0gLXJlc1xyXG5cdFx0cGFyYW0uSW50ZWdlciBNYXRoLnJvdW5kIHJlc1xyXG5cdGFzcyA0KlNJWkUsY2FsY0JhciBcIjIxMDBcIlxyXG5cdGFzcyA0KlNJWkUsY2FsY0JhciBcIjIwMDBcIlxyXG5cdGFzcyAyKlNJWkUsY2FsY0JhciBcIjEwMDBcIlxyXG5cdGFzcyBTSVpFLGNhbGNCYXIgXCI1MDBcIlxyXG5cdGFzcyAwLGNhbGNCYXIgXCIxXCJcclxuXHRhc3MgLVNJWkUsY2FsY0JhciBcIi01MDBcIlxyXG5cdGFzcyAtNCpTSVpFLGNhbGNCYXIgXCIjLTFcIlxyXG4iXX0=
//# sourceURL=c:\github\2023-019-ChessTree\coffee\board.coffee