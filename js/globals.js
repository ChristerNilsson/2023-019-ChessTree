// Generated by CoffeeScript 2.5.1
var f, g, link, sortera, undo,
  modulo = function(a, b) { return (+a % (b = +b) + b) % b; },
  indexOf = [].indexOf;

import {
  ass,
  log,
  range,
  split,
  param,
  hexToBase64,
  spaceShip
} from '../js/utils.js';

import {
  Button
} from '../js/button.js';

import _ from 'https://cdn.skypack.dev/lodash';

import cryptoJs from 'https://cdn.skypack.dev/crypto-js';

import {
  download
} from '../js/download.js';

export var global = {
  //name : 'bishop',
  name: 'rousseau',
  version: 'ver: B',
  board: null,
  child: 0, // move under consideration
  children: [], // sorted list of [value,san,uci]
  SIZE: 50, // of square
  pics: {}, // 12 pjäser
  data: null,
  buttons: [],
  database: {}, // fen => value
  currTree: 0, // index till träden
  currNode: null, // pekar in i ett träd
  count: 0, // räknar antal nya drag i trädet
  stack: [] // innehåller aktuell gren
};

export var coords = (uci) => {
  var c0, c1, r0, r1;
  param.String(uci);
  c0 = "abcdefgh".indexOf(uci[0]);
  r0 = "12345678".indexOf(uci[1]);
  c1 = "abcdefgh".indexOf(uci[2]);
  r1 = "12345678".indexOf(uci[3]);
  return param.Array([c0 + 8 * r0, c1 + 8 * r1]);
};

ass([8, 24], coords("a2a4"));

export var toUCI = ([from, to]) => {
  var c0, c1, r0, r1;
  param.Integer(from);
  param.Integer(to);
  c0 = "abcdefgh"[from % 8];
  r0 = "12345678"[Math.floor(from / 8)];
  c1 = "abcdefgh"[to % 8];
  r1 = "12345678"[Math.floor(to / 8)];
  return param.String(c0 + r0 + c1 + r1);
};

ass("e2e4", toUCI([12, 28]));

export var toObjectNotation = ([from, to]) => {
  var uci;
  param.Integer(from);
  param.Integer(to);
  uci = toUCI([from, to]);
  from = uci.slice(0, 2);
  to = uci.slice(2, 4);
  return param.Object({from, to});
};

ass({
  from: 'e2',
  to: 'e4'
}, toObjectNotation([12, 28]));

export var empty = (n) => {
  param.Integer(n);
  return param.String((1 + Math.floor(n / 8)).toString());
};

undo = () => {
  if (global.stack.length === 0) {
    return;
  }
  global.chess.undo();
  global.currNode = global.stack.pop();
  return makeChildren();
};

export var dumpState = () => {
  console.log('STATE ########');
  console.log('  stack', global.stack);
  console.log('  currNode', global.currNode);
  return console.log('  history', global.chess.history());
};

export var makeChildren = () => {
  var base64, fen, i, j, key, keys, len, pair, ref, san, value;
  console.log('makeChildren');
  keys = _.keys(global.currNode);
  global.children = [];
  ref = range(keys.length);
  for (j = 0, len = ref.length; j < len; j++) {
    i = ref[j];
    key = keys[i];
    pair = coords(key);
    global.chess.move(toObjectNotation(pair));
    fen = global.chess.fen();
    san = _.last(global.chess.history());
    base64 = hexToBase64(cryptoJs.SHA256(fen).toString()).slice(0, 8);
    value = global.database[base64] === null ? "?" : global.database[base64];
    global.children.push([value, san, key]);
    console.log(key, san, base64, value, fen);
    global.chess.undo();
  }
  global.children = sortera(global.children);
  if (modulo(global.stack.length, 2) === 0) {
    global.children.reverse();
  }
  global.child = 0;
  return console.log('children', global.children);
};

sortera = (arr) => { // Hanterar ej mattar av olika längd. 
  // #1 och #2 ersätts båda med 9999
  // #-1 och #-2 ersätts båda med -9999
  // Bör: #1 > #2
  // Är: #1 == #2
  param.Array(arr);
  arr = _.map(arr, ([a, b, c]) => {
    if (typeof a === 'number') {
      return [a, b, c];
    }
    if (a[1] === '-') {
      return [-9999, b, c];
    } else {
      return [9999, b, c];
    }
  });
  return arr.sort((a, b) => {
    return spaceShip(a[0], b[0]);
  });
};

ass([[2, "Nf3", "g1f3"], [11, "e4", "e2e4"]], sortera([[11, "e4", "e2e4"], [2, "Nf3", "g1f3"]]));

ass([[-9999, "Nf3", "g1f3"], [9999, "e4", "e2e4"]], sortera([["#1", "e4", "e2e4"], ["#-2", "Nf3", "g1f3"]]));

ass([[-9999, "Nf3", "g1f3"], [11, "e4", "e2e4"]], sortera([[11, "e4", "e2e4"], ["#-2", "Nf3", "g1f3"]]));

export var loadTree = (delta) => {
  param.Test(delta === (-1) || delta === 0 || delta === 1);
  global.currTree = modulo(global.currTree + delta, _.size(global.trees));
  global.currNode = global.tree; //.moves[""]
  global.stack = [];
  return makeChildren();
};

g = (item) => {
  // param.Integer item or param.String
  if (indexOf.call(item, "#-") >= 0) {
    return -1000;
  }
  if (indexOf.call(item, "#") >= 0) {
    return 1000;
  }
  return param.Integer(parseInt(item));
};

f = (arrScore, c) => {
  var a, b, d;
  param.Array(arrScore);
  param.String(c);
  arrScore = _.map(arrScore, (item) => {
    return g(item);
  });
  a = _.min(arrScore);
  b = _.max(arrScore);
  c = g(c);
  d = _.max([Math.abs(a), Math.abs(b)]);
  a = -d;
  return param.Number((c - a) / (2 * d));
};

ass(0, f([-100, 50], '-100'));

ass(0.75, f([-100, 50], '50'));

ass(1, f([-100, 50], '100'));

link = () => {
  return 'https://lichess.org/analysis/' + global.chess.fen();
};

export var clickString = (key) => {
  var san, uci, value;
  param.String(key);
  if (key === 'flip') {
    return global.board.flip();
  } else if (key === 'link') {
    return window.open(link(), '_blank');
  } else if (key === 'up') {
    return global.child = modulo(global.child + 1, global.children.length);
  } else if (key === 'down') {
    return global.child = modulo(global.child - 1, global.children.length);
  } else if (key === 'undo') {
    return undo();
  } else if (key === 'left') {
    return undo();
  } else if (key === 'right') {
    [value, san, uci] = global.children[global.child];
    console.log('move', [value, san, uci]);
    global.chess.move(san);
    global.stack.push(global.currNode);
    global.currNode = global.currNode[uci];
    return makeChildren();
  } else if (key === 'save') {
    return download(global.tree, global.name + '.json');
  } else {
    return console.log('unknown key in clickString', key);
  }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2xvYmFscy5qcyIsInNvdXJjZVJvb3QiOiIuLiIsInNvdXJjZXMiOlsiY29mZmVlXFxnbG9iYWxzLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLElBQUEsRUFBQSxPQUFBLEVBQUEsSUFBQTtFQUFBOzs7QUFBQSxPQUFBO0VBQVEsR0FBUjtFQUFZLEdBQVo7RUFBZ0IsS0FBaEI7RUFBc0IsS0FBdEI7RUFBNEIsS0FBNUI7RUFBa0MsV0FBbEM7RUFBOEMsU0FBOUM7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxNQUFSO0NBQUEsTUFBQTs7QUFDQSxPQUFPLENBQVAsTUFBQTs7QUFDQSxPQUFPLFFBQVAsTUFBQTs7QUFDQSxPQUFBO0VBQVEsUUFBUjtDQUFBLE1BQUE7O0FBRUEsT0FBQSxJQUFPLE1BQUEsR0FBUyxDQUFBOztFQUdmLElBQUEsRUFBTyxVQUhRO0VBS2YsT0FBQSxFQUFRLFFBTE87RUFNZixLQUFBLEVBQU0sSUFOUztFQU9mLEtBQUEsRUFBTSxDQVBTO0VBUWYsUUFBQSxFQUFVLEVBUks7RUFTZixJQUFBLEVBQUssRUFUVTtFQVVmLElBQUEsRUFBSyxDQUFBLENBVlU7RUFXZixJQUFBLEVBQUssSUFYVTtFQVlmLE9BQUEsRUFBUSxFQVpPO0VBYWYsUUFBQSxFQUFVLENBQUEsQ0FiSztFQWNmLFFBQUEsRUFBUyxDQWRNO0VBZWYsUUFBQSxFQUFTLElBZk07RUFnQmYsS0FBQSxFQUFPLENBaEJRO0VBaUJmLEtBQUEsRUFBTSxFQWpCUztBQUFBOztBQW9CaEIsT0FBQSxJQUFPLE1BQUEsR0FBUyxDQUFDLEdBQUQsQ0FBQSxHQUFBO0FBQ2hCLE1BQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUE7RUFBQyxLQUFLLENBQUMsTUFBTixDQUFhLEdBQWI7RUFDQSxFQUFBLEdBQUssVUFBVSxDQUFDLE9BQVgsQ0FBbUIsR0FBRyxDQUFDLENBQUQsQ0FBdEI7RUFDTCxFQUFBLEdBQUss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O0lBQ0EsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFiLENBQWtCLEdBQWxCO0lBQ0EsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFiLENBQWtCLE1BQU0sQ0FBQyxRQUF6QjtJQUNBLE1BQU0sQ0FBQyxRQUFQLEdBQWtCLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBRDtXQUNqQyxZQUFBLENBQUEsRUFOSTtHQUFBLE1BT0EsSUFBRyxHQUFBLEtBQU8sTUFBVjtXQUFzQixRQUFBLENBQVMsTUFBTSxDQUFDLElBQWhCLEVBQXNCLE1BQU0sQ0FBQyxJQUFQLEdBQWMsT0FBcEMsRUFBdEI7R0FBQSxNQUFBO1dBQ0EsT0FBTyxDQUFDLEdBQVIsQ0FBWSw0QkFBWixFQUF5QyxHQUF6QyxFQURBOztBQWZlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHthc3MsbG9nLHJhbmdlLHNwbGl0LHBhcmFtLGhleFRvQmFzZTY0LHNwYWNlU2hpcH0gZnJvbSAnLi4vanMvdXRpbHMuanMnXHJcbmltcG9ydCB7QnV0dG9ufSBmcm9tICcuLi9qcy9idXR0b24uanMnXHJcbmltcG9ydCBfIGZyb20gJ2h0dHBzOi8vY2RuLnNreXBhY2suZGV2L2xvZGFzaCdcclxuaW1wb3J0IGNyeXB0b0pzIGZyb20gJ2h0dHBzOi8vY2RuLnNreXBhY2suZGV2L2NyeXB0by1qcydcclxuaW1wb3J0IHtkb3dubG9hZH0gZnJvbSAnLi4vanMvZG93bmxvYWQuanMnXHJcblxyXG5leHBvcnQgZ2xvYmFsID0ge1xyXG5cclxuXHQjbmFtZSA6ICdiaXNob3AnLFxyXG5cdG5hbWUgOiAncm91c3NlYXUnLFxyXG5cclxuXHR2ZXJzaW9uOid2ZXI6IEInLFxyXG5cdGJvYXJkOm51bGwsXHJcblx0Y2hpbGQ6MCwgIyBtb3ZlIHVuZGVyIGNvbnNpZGVyYXRpb25cclxuXHRjaGlsZHJlbjogW10sICMgc29ydGVkIGxpc3Qgb2YgW3ZhbHVlLHNhbix1Y2ldXHJcblx0U0laRTo1MCwgIyBvZiBzcXVhcmVcclxuXHRwaWNzOnt9LCAjIDEyIHBqw6RzZXJcclxuXHRkYXRhOm51bGwsXHJcblx0YnV0dG9uczpbXSxcclxuXHRkYXRhYmFzZToge30sICMgZmVuID0+IHZhbHVlXHJcblx0Y3VyclRyZWU6MCwgIyBpbmRleCB0aWxsIHRyw6RkZW5cclxuXHRjdXJyTm9kZTpudWxsLCAjIHBla2FyIGluIGkgZXR0IHRyw6RkXHJcblx0Y291bnQ6IDAsICMgcsOka25hciBhbnRhbCBueWEgZHJhZyBpIHRyw6RkZXRcclxuXHRzdGFjazpbXSAjIGlubmVow6VsbGVyIGFrdHVlbGwgZ3JlblxyXG59XHJcblxyXG5leHBvcnQgY29vcmRzID0gKHVjaSkgPT5cclxuXHRwYXJhbS5TdHJpbmcgdWNpXHJcblx0YzAgPSBcImFiY2RlZmdoXCIuaW5kZXhPZiB1Y2lbMF1cclxuXHRyMCA9IFwiMTIzNDU2NzhcIi5pbmRleE9mIHVjaVsxXVxyXG5cdGMxID0gXCJhYmNkZWZnaFwiLmluZGV4T2YgdWNpWzJdXHJcblx0cjEgPSBcIjEyMzQ1Njc4XCIuaW5kZXhPZiB1Y2lbM11cclxuXHRwYXJhbS5BcnJheSBbYzArOCpyMCwgYzErOCpyMV1cclxuYXNzIFs4LDI0XSwgY29vcmRzIFwiYTJhNFwiXHJcblxyXG5leHBvcnQgdG9VQ0kgPSAoW2Zyb20sdG9dKSA9PlxyXG5cdHBhcmFtLkludGVnZXIgZnJvbVxyXG5cdHBhcmFtLkludGVnZXIgdG9cclxuXHRjMCA9IFwiYWJjZGVmZ2hcIltmcm9tJThdXHJcblx0cjAgPSBcIjEyMzQ1Njc4XCJbZnJvbS8vOF1cclxuXHRjMSA9IFwiYWJjZGVmZ2hcIlt0byU4XVxyXG5cdHIxID0gXCIxMjM0NTY3OFwiW3RvLy84XVxyXG5cdHBhcmFtLlN0cmluZyBjMCtyMCtjMStyMVxyXG5hc3MgXCJlMmU0XCIsIHRvVUNJIFsxMiwyOF1cclxuXHJcbmV4cG9ydCB0b09iamVjdE5vdGF0aW9uID0gKFtmcm9tLHRvXSkgPT5cclxuXHRwYXJhbS5JbnRlZ2VyIGZyb21cclxuXHRwYXJhbS5JbnRlZ2VyIHRvXHJcblx0dWNpID0gdG9VQ0kgW2Zyb20sdG9dXHJcblx0ZnJvbSA9IHVjaS5zbGljZSAwLDJcclxuXHR0byA9IHVjaS5zbGljZSAyLDRcclxuXHRwYXJhbS5PYmplY3Qge2Zyb20sIHRvfVxyXG5hc3Mge2Zyb206J2UyJywgdG86J2U0J30sIHRvT2JqZWN0Tm90YXRpb24gWzEyLDI4XVxyXG5cclxuZXhwb3J0IGVtcHR5ID0gKG4pID0+XHJcblx0cGFyYW0uSW50ZWdlciBuXHJcblx0cGFyYW0uU3RyaW5nICgxK24vLzgpLnRvU3RyaW5nKClcclxuXHJcbnVuZG8gPSA9PiBcclxuXHRpZiBnbG9iYWwuc3RhY2subGVuZ3RoID09IDAgdGhlbiByZXR1cm5cclxuXHRnbG9iYWwuY2hlc3MudW5kbygpXHJcblx0Z2xvYmFsLmN1cnJOb2RlID0gZ2xvYmFsLnN0YWNrLnBvcCgpXHJcblx0bWFrZUNoaWxkcmVuKClcclxuXHJcbmV4cG9ydCBkdW1wU3RhdGUgPSA9PlxyXG5cdGNvbnNvbGUubG9nICdTVEFURSAjIyMjIyMjIydcclxuXHRjb25zb2xlLmxvZyAnICBzdGFjaycsZ2xvYmFsLnN0YWNrXHJcblx0Y29uc29sZS5sb2cgJyAgY3Vyck5vZGUnLGdsb2JhbC5jdXJyTm9kZVxyXG5cdGNvbnNvbGUubG9nICcgIGhpc3RvcnknLGdsb2JhbC5jaGVzcy5oaXN0b3J5KClcclxuXHJcbmV4cG9ydCBtYWtlQ2hpbGRyZW4gPSA9PlxyXG5cdGNvbnNvbGUubG9nICdtYWtlQ2hpbGRyZW4nXHJcblx0a2V5cyA9IF8ua2V5cyBnbG9iYWwuY3Vyck5vZGVcclxuXHRnbG9iYWwuY2hpbGRyZW4gPSBbXVxyXG5cdGZvciBpIGluIHJhbmdlIGtleXMubGVuZ3RoXHJcblx0XHRrZXkgPSBrZXlzW2ldXHJcblx0XHRwYWlyID0gY29vcmRzIGtleVxyXG5cdFx0Z2xvYmFsLmNoZXNzLm1vdmUgdG9PYmplY3ROb3RhdGlvbiBwYWlyXHJcblx0XHRmZW4gPSBnbG9iYWwuY2hlc3MuZmVuKClcclxuXHRcdHNhbiA9IF8ubGFzdCBnbG9iYWwuY2hlc3MuaGlzdG9yeSgpXHJcblx0XHRiYXNlNjQgPSBoZXhUb0Jhc2U2NChjcnlwdG9Kcy5TSEEyNTYoZmVuKS50b1N0cmluZygpKS5zbGljZSAwLDhcclxuXHRcdHZhbHVlID0gaWYgZ2xvYmFsLmRhdGFiYXNlW2Jhc2U2NF0gPT0gbnVsbCB0aGVuIFwiP1wiIGVsc2UgZ2xvYmFsLmRhdGFiYXNlW2Jhc2U2NF1cclxuXHRcdGdsb2JhbC5jaGlsZHJlbi5wdXNoIFt2YWx1ZSxzYW4sa2V5XVxyXG5cdFx0Y29uc29sZS5sb2cga2V5LCBzYW4sIGJhc2U2NCwgdmFsdWUsIGZlblxyXG5cdFx0Z2xvYmFsLmNoZXNzLnVuZG8oKVxyXG5cdGdsb2JhbC5jaGlsZHJlbiA9IHNvcnRlcmEgZ2xvYmFsLmNoaWxkcmVuXHJcblx0aWYgZ2xvYmFsLnN0YWNrLmxlbmd0aCUlMj09MCB0aGVuIGdsb2JhbC5jaGlsZHJlbi5yZXZlcnNlKClcclxuXHRnbG9iYWwuY2hpbGQgPSAwXHJcblx0Y29uc29sZS5sb2cgJ2NoaWxkcmVuJyxnbG9iYWwuY2hpbGRyZW5cclxuXHJcbnNvcnRlcmEgPSAoYXJyKSA9PiAjIEhhbnRlcmFyIGVqIG1hdHRhciBhdiBvbGlrYSBsw6RuZ2QuIFxyXG5cdCMgIzEgb2NoICMyIGVyc8OkdHRzIGLDpWRhIG1lZCA5OTk5XHJcblx0IyAjLTEgb2NoICMtMiBlcnPDpHR0cyBiw6VkYSBtZWQgLTk5OTlcclxuXHQjIELDtnI6ICMxID4gIzJcclxuXHQjIMOEcjogIzEgPT0gIzJcclxuXHRwYXJhbS5BcnJheSBhcnJcclxuXHRhcnIgPSBfLm1hcCBhcnIsIChbYSxiLGNdKSA9PiBcclxuXHRcdGlmIHR5cGVvZiBhPT0nbnVtYmVyJyB0aGVuIHJldHVybiBbYSxiLGNdXHJcblx0XHRpZiBhWzFdPT0nLScgdGhlbiByZXR1cm4gWy05OTk5LGIsY10gZWxzZSByZXR1cm4gWzk5OTksYixjXVxyXG5cdGFyci5zb3J0IChhLGIpID0+IHNwYWNlU2hpcCBhWzBdLGJbMF1cclxuYXNzIFtbMixcIk5mM1wiLFwiZzFmM1wiXSxbMTEsXCJlNFwiLFwiZTJlNFwiXV0sIHNvcnRlcmEgW1sxMSxcImU0XCIsXCJlMmU0XCJdLFsyLFwiTmYzXCIsXCJnMWYzXCJdXVxyXG5hc3MgW1stOTk5OSxcIk5mM1wiLFwiZzFmM1wiXSxbOTk5OSxcImU0XCIsXCJlMmU0XCJdXSwgc29ydGVyYSBbW1wiIzFcIixcImU0XCIsXCJlMmU0XCJdLFtcIiMtMlwiLFwiTmYzXCIsXCJnMWYzXCJdXVxyXG5hc3MgW1stOTk5OSxcIk5mM1wiLFwiZzFmM1wiXSxbMTEsXCJlNFwiLFwiZTJlNFwiXV0sIHNvcnRlcmEgW1sxMSxcImU0XCIsXCJlMmU0XCJdLFtcIiMtMlwiLFwiTmYzXCIsXCJnMWYzXCJdXVxyXG5cclxuZXhwb3J0IGxvYWRUcmVlID0gKGRlbHRhKSA9PlxyXG5cdHBhcmFtLlRlc3QgZGVsdGEgaW4gWy0xLDAsMV1cclxuXHRnbG9iYWwuY3VyclRyZWUgPSAoZ2xvYmFsLmN1cnJUcmVlK2RlbHRhKSAlJSBfLnNpemUgZ2xvYmFsLnRyZWVzXHJcblx0Z2xvYmFsLmN1cnJOb2RlID0gZ2xvYmFsLnRyZWUgIy5tb3Zlc1tcIlwiXVxyXG5cdGdsb2JhbC5zdGFjayA9IFtdXHJcblx0bWFrZUNoaWxkcmVuKClcclxuXHJcbmcgPSAoaXRlbSkgPT5cclxuXHQjIHBhcmFtLkludGVnZXIgaXRlbSBvciBwYXJhbS5TdHJpbmdcclxuXHRpZiBcIiMtXCIgaW4gaXRlbSB0aGVuIHJldHVybiAtMTAwMFxyXG5cdGlmIFwiI1wiIGluIGl0ZW0gdGhlbiByZXR1cm4gMTAwMFxyXG5cdHBhcmFtLkludGVnZXIgcGFyc2VJbnQgaXRlbVxyXG5cclxuZiA9IChhcnJTY29yZSxjKSA9PlxyXG5cdHBhcmFtLkFycmF5IGFyclNjb3JlXHJcblx0cGFyYW0uU3RyaW5nIGNcclxuXHRhcnJTY29yZSA9IF8ubWFwIGFyclNjb3JlLCAoaXRlbSkgPT4gZyBpdGVtXHJcblx0YSA9IF8ubWluIGFyclNjb3JlXHJcblx0YiA9IF8ubWF4IGFyclNjb3JlXHJcblx0YyA9IGcgY1xyXG5cdGQgPSBfLm1heCBbTWF0aC5hYnMoYSksTWF0aC5hYnMoYildXHJcblx0YSA9IC1kXHJcblx0cGFyYW0uTnVtYmVyIChjLWEpLygyKmQpXHJcbmFzcyAwLCBmIFstMTAwLDUwXSwnLTEwMCdcclxuYXNzIDAuNzUsIGYgWy0xMDAsNTBdLCc1MCdcclxuYXNzIDEsIGYgWy0xMDAsNTBdLCcxMDAnXHJcblxyXG5saW5rID0gPT4gJ2h0dHBzOi8vbGljaGVzcy5vcmcvYW5hbHlzaXMvJyArIGdsb2JhbC5jaGVzcy5mZW4oKVxyXG5cclxuZXhwb3J0IGNsaWNrU3RyaW5nID0gKGtleSkgPT5cclxuXHRwYXJhbS5TdHJpbmcga2V5XHJcblx0aWYga2V5ID09ICdmbGlwJyB0aGVuIGdsb2JhbC5ib2FyZC5mbGlwKClcclxuXHRlbHNlIGlmIGtleSA9PSAnbGluaycgdGhlbiB3aW5kb3cub3BlbiBsaW5rKCksICdfYmxhbmsnXHJcblx0ZWxzZSBpZiBrZXkgPT0gJ3VwJyAgIHRoZW4gZ2xvYmFsLmNoaWxkID0gKGdsb2JhbC5jaGlsZCsxKSAlJSBnbG9iYWwuY2hpbGRyZW4ubGVuZ3RoXHJcblx0ZWxzZSBpZiBrZXkgPT0gJ2Rvd24nIHRoZW4gZ2xvYmFsLmNoaWxkID0gKGdsb2JhbC5jaGlsZC0xKSAlJSBnbG9iYWwuY2hpbGRyZW4ubGVuZ3RoXHJcblx0ZWxzZSBpZiBrZXkgPT0gJ3VuZG8nIHRoZW4gdW5kbygpXHJcblx0ZWxzZSBpZiBrZXkgPT0gJ2xlZnQnIHRoZW4gdW5kbygpXHJcblx0ZWxzZSBpZiBrZXkgPT0gJ3JpZ2h0J1xyXG5cdFx0W3ZhbHVlLHNhbix1Y2ldID0gZ2xvYmFsLmNoaWxkcmVuW2dsb2JhbC5jaGlsZF1cclxuXHRcdGNvbnNvbGUubG9nICdtb3ZlJyxbdmFsdWUsc2FuLHVjaV1cclxuXHRcdGdsb2JhbC5jaGVzcy5tb3ZlIHNhblxyXG5cdFx0Z2xvYmFsLnN0YWNrLnB1c2ggZ2xvYmFsLmN1cnJOb2RlXHJcblx0XHRnbG9iYWwuY3Vyck5vZGUgPSBnbG9iYWwuY3Vyck5vZGVbdWNpXVxyXG5cdFx0bWFrZUNoaWxkcmVuKClcclxuXHRlbHNlIGlmIGtleSA9PSAnc2F2ZScgdGhlbiBkb3dubG9hZCBnbG9iYWwudHJlZSwgZ2xvYmFsLm5hbWUgKyAnLmpzb24nXHJcblx0ZWxzZSBjb25zb2xlLmxvZyAndW5rbm93biBrZXkgaW4gY2xpY2tTdHJpbmcnLGtleVxyXG4iXX0=
//# sourceURL=c:\github\2023-019-ChessTree\coffee\globals.coffee